/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/codejar@4.3.0/dist/codejar.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const globalWindow=window;window.CodeJar = function CodeJar(t,e,n={}){const o={tab:"\t",indentOn:/[({\[]$/,moveToNewLine:/^[)}\]]/,spellcheck:!1,catchTab:!0,preserveIdent:!0,addClosing:!0,history:!0,window:globalWindow,autoclose:{open:"([{'\"",close:")]}'\""},...n},r=o.window,i=r.document,s=[],a=[];let d,c=-1,l=!1,f=()=>{};t.setAttribute("contenteditable","plaintext-only"),t.setAttribute("spellcheck",o.spellcheck?"true":"false"),t.style.outline="none",t.style.overflowWrap="break-word",t.style.overflowY="auto",t.style.whiteSpace="pre-wrap";const u=(t,n)=>{e(t,n)},p=r.navigator.userAgent.match(/Firefox\/([0-9]+)\./),h=p?parseInt(p[1]):0;let g=!1;("plaintext-only"!==t.contentEditable||h>=136)&&(g=!0),g&&t.setAttribute("contenteditable","true");const y=H((()=>{const e=b();u(t,e),E(e)}),30);let N=!1;const m=t=>!S(t)&&!A(t)&&"Meta"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&!t.key.startsWith("Arrow"),C=H((t=>{m(t)&&(O(),N=!1)}),300),T=(e,n)=>{s.push([e,n]),t.addEventListener(e,n)};function b(){const e=_(),n={start:0,end:0,dir:void 0};let{anchorNode:o,anchorOffset:r,focusNode:s,focusOffset:a}=e;if(!o||!s)throw"error1";if(o===t&&s===t)return n.start=r>0&&t.textContent?t.textContent.length:0,n.end=a>0&&t.textContent?t.textContent.length:0,n.dir=a>=r?"->":"<-",n;if(o.nodeType===Node.ELEMENT_NODE){const t=i.createTextNode("");o.insertBefore(t,o.childNodes[r]),o=t,r=0}if(s.nodeType===Node.ELEMENT_NODE){const t=i.createTextNode("");s.insertBefore(t,s.childNodes[a]),s=t,a=0}return M(t,(t=>{if(t===o&&t===s)return n.start+=r,n.end+=a,n.dir=r<=a?"->":"<-","stop";if(t===o){if(n.start+=r,n.dir)return"stop";n.dir="->"}else if(t===s){if(n.end+=a,n.dir)return"stop";n.dir="<-"}t.nodeType===Node.TEXT_NODE&&("->"!=n.dir&&(n.start+=t.nodeValue.length),"<-"!=n.dir&&(n.end+=t.nodeValue.length))})),t.normalize(),n}function E(e){const n=_();let o,r,s=0,a=0;if(e.dir||(e.dir="->"),e.start<0&&(e.start=0),e.end<0&&(e.end=0),"<-"==e.dir){const{start:t,end:n}=e;e.start=n,e.end=t}let d=0;M(t,(t=>{if(t.nodeType!==Node.TEXT_NODE)return;const n=(t.nodeValue||"").length;if(d+n>e.start&&(o||(o=t,s=e.start-d),d+n>e.end))return r=t,a=e.end-d,"stop";d+=n})),o||(o=t,s=t.childNodes.length),r||(r=t,a=t.childNodes.length),"<-"==e.dir&&([o,s,r,a]=[r,a,o,s]);{const t=x(o);if(t){const e=i.createTextNode("");t.parentNode?.insertBefore(e,t),o=e,s=0}const e=x(r);if(e){const t=i.createTextNode("");e.parentNode?.insertBefore(t,e),r=t,a=0}}n.setBaseAndExtent(o,s,r,a),t.normalize()}function x(e){for(;e&&e!==t;){if(e.nodeType===Node.ELEMENT_NODE){const t=e;if("false"==t.getAttribute("contenteditable"))return t}e=e.parentNode}}function w(){const e=_().getRangeAt(0),n=i.createRange();return n.selectNodeContents(t),n.setEnd(e.startContainer,e.startOffset),n.toString()}function k(){const e=_().getRangeAt(0),n=i.createRange();return n.selectNodeContents(t),n.setStart(e.endContainer,e.endOffset),n.toString()}function v(t){if(g&&"Enter"===t.key)if(R(t),t.stopPropagation(),""==k()){B("\n ");const t=b();t.start=--t.end,E(t)}else B("\n")}function O(){if(!l)return;const e=t.innerHTML,n=b(),o=a[c];if(o&&o.html===e&&o.pos.start===n.start&&o.pos.end===n.end)return;c++,a[c]={html:e,pos:n},a.splice(c+1);c>300&&(c=300,a.splice(0,1))}function M(t,e){const n=[];t.firstChild&&n.push(t.firstChild);let o=n.pop();for(;o&&"stop"!==e(o);)o.nextSibling&&n.push(o.nextSibling),o.firstChild&&n.push(o.firstChild),o=n.pop()}function L(t){return t.metaKey||t.ctrlKey}function S(t){return L(t)&&!t.shiftKey&&"Z"===D(t)}function A(t){return L(t)&&t.shiftKey&&"Z"===D(t)}function D(t){let e=t.key||t.keyCode||t.which;if(e)return("string"==typeof e?e:String.fromCharCode(e)).toUpperCase()}function B(t){t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),i.execCommand("insertHTML",!1,t)}function H(t,e){let n=0;return(...o)=>{clearTimeout(n),n=r.setTimeout((()=>t(...o)),e)}}function K(t){let e=t.length-1;for(;e>=0&&"\n"!==t[e];)e--;e++;let n=e;for(;n<t.length&&/[ \t]/.test(t[n]);)n++;return[t.substring(e,n)||"",e,n]}function P(){return t.textContent||""}function R(t){t.preventDefault()}function _(){return t.getRootNode().getSelection()}return T("keydown",(e=>{e.defaultPrevented||(d=P(),o.preserveIdent?function(t){if("Enter"===t.key){const e=w(),n=k();let[r]=K(e),i=r;if(o.indentOn.test(e)&&(i+=o.tab),i.length>0?(R(t),t.stopPropagation(),B("\n"+i)):v(t),i!==r&&o.moveToNewLine.test(n)){const t=b();B("\n"+r),E(t)}}}(e):v(e),o.catchTab&&function(t){if("Tab"===t.key)if(R(t),t.shiftKey){const t=w();let[e,n]=K(t);if(e.length>0){const t=b(),r=Math.min(o.tab.length,e.length);E({start:n,end:n+r}),i.execCommand("delete"),t.start-=r,t.end-=r,E(t)}}else B(o.tab)}(e),o.addClosing&&function(t){const e=o.autoclose.open,n=o.autoclose.close;if(e.includes(t.key)){R(t);const o=b(),r=o.start==o.end?"":_().toString();B(t.key+r+(n[e.indexOf(t.key)]??"")),o.start++,o.end++,E(o)}}(e),o.history&&(!function(e){if(S(e)){R(e),c--;const n=a[c];n&&(t.innerHTML=n.html,E(n.pos)),c<0&&(c=0)}if(A(e)){R(e),c++;const n=a[c];n&&(t.innerHTML=n.html,E(n.pos)),c>=a.length&&c--}}(e),m(e)&&!N&&(O(),N=!0)),g&&!function(t){return L(t)&&"C"===D(t)}(e)&&E(b()))})),T("keyup",(t=>{t.defaultPrevented||t.isComposing||(d!==P()&&y(),C(t),f(P()))})),T("focus",(t=>{l=!0})),T("blur",(t=>{l=!1})),T("paste",(e=>{O(),function(e){if(e.defaultPrevented)return;R(e);const n=e.originalEvent??e,o=n.clipboardData.getData("text/plain").replace(/\r\n?/g,"\n"),r=b();B(o),u(t),E({start:Math.min(r.start,r.end)+o.length,end:Math.min(r.start,r.end)+o.length,dir:"<-"})}(e),O(),f(P())})),T("cut",(e=>{O(),function(e){const n=b(),o=_(),r=e.originalEvent??e;r.clipboardData.setData("text/plain",o.toString()),i.execCommand("delete"),u(t),E({start:Math.min(n.start,n.end),end:Math.min(n.start,n.end),dir:"<-"}),R(e)}(e),O(),f(P())})),{updateOptions(t){Object.assign(o,t)},updateCode(e,n=!0){t.textContent=e,u(t),n&&f(e)},onUpdate(t){f=t},toString:P,save:b,restore:E,recordHistory:O,destroy(){for(let[e,n]of s)t.removeEventListener(e,n)}}}
//# sourceMappingURL=/sm/bdf6b6bdc4b4fd86a9e8c089af63ab6287c34f654d0893a5bd834f7e7728351d.map